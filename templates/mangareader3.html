<!DOCTYPE html>
<html>
<head>
<title>AtomMangaReader: Ch: {{ ch_no }} Pg: {{ p_no }}/{{ pg_last }}</title>

<style>
.menu_list {
    display: block;
    color: #e0e0e0;
    font-family: 'Roboto', sans-serif;
    font-size: 34px;
    font-weight: 500;
    text-decoration: none;
    padding: 1.2vh 0;
}

/* TABLE FIX */
td {
    text-align: center;
    width: 100%;
}

/* FLOATING CONTROLS */
.controls-toggle {
    position: fixed;
    top: 2vh;
    left: 2vw;
    background: rgba(0,0,0,0.65);
    color: #e0e0e0;
    font-size: 26px;
    padding: 1vh 2vw;
    border-radius: 6px;
    z-index: 1000;
}

.controls-box {
    display: none;
    position: fixed;
    top: 7vh;
    left: 2vw;
    background: rgba(20,20,20,0.9);
    padding: 2vh 2vw;
    border-radius: 8px;
    z-index: 1000;
}

.controls-box a,
.controls-box button,
.controls-box input,
.page-info {
    display: block;
    margin: 1vh 0;
    font-size: 26px;
    color: #e0e0e0;
    background: #222;
    border: none;
    padding: 1vh 2vw;
    border-radius: 5px;
    text-align: center;
    text-decoration: none;
}

.controls-box input {
    background: #fff;
    color: #000;
    padding: 0.6vh;
}

/* PAGE INFO */
.page-info {
    background: transparent;
    font-size: 24px;
    padding: 0.5vh 0;
}
</style>
</head>

<body style="margin: 0; padding: 0; zoom: 60%; background: black;">

<!-- MAIN IMAGE -->
<img
    src="{{ reader_src[p_no-1] }}"
    style="display: block; margin-left: auto; margin-right: auto; min-height: 100vh; width: auto;"
>

<!-- TAP ZONES -->

{% if p_no + 1 <= pg_last %}
<a href="/manga_reader/ch/{{ ch_no }}/p{{ p_no + 1 }}">
{% else %}
<a href="/manga_reader/ch/{{ ch_no }}/p{{ p_no }}">
{% endif %}
<div style="position: fixed; left: 0%; top: 0%; width: 25%; height: 100vh;"></div>
</a>

{% if p_no - 1 >= 1 %}
<a href="/manga_reader/ch/{{ ch_no }}/p{{ p_no - 1 }}">
{% else %}
<a href="/manga_reader/ch/{{ ch_no }}/p1">
{% endif %}
<div style="position: fixed; left: 75%; top: 0%; width: 25%; height: 100vh;"></div>
</a>

<!-- CONTROLS TOGGLE -->
<div class="controls-toggle" onclick="ToggleControls()">Menu</div>

<!-- CONTROLS BOX -->
<div id="controlsBox" class="controls-box">

    <div class="page-info">
        Page {{ p_no }} / {{ pg_last }}
    </div>

    <a href="{{ manga_home_link }}">Manga Home</a>

    <input id="pageInput" type="number" min="1" max="{{ pg_last }}" placeholder="Go to page">
    <button onclick="GoToPage()">Go</button>

</div>

<!-- MENU TOGGLE (CENTER TAP) -->
<div onclick="ShowMenu()" style="position: fixed; left: 35%; top: 35%; width: 30vh; height: 30vh;"></div>

<!-- MENU -->
<div id="myDropdown" style="display: none; position: fixed; left: 20%; top: 4vh; width: 60vw; min-height: 92vh; background: rgba(20,20,20,0.95); border-radius: 10px;">
    <table style="width: 100%; height: 100%; padding-top: 3vh;">
        <tr><td><button onclick="ShowMenu()" class="menu_list">Close</button></td></tr>
        <tr><td><a class="menu_list" href="{{ next_ch_link }}">Next Chapter</a></td></tr>
        <tr><td><a class="menu_list" href="{{ prev_ch_link }}">Previous Chapter</a></td></tr>
        <tr><td><a class="menu_list" href="{{ manga_home_link }}">Manga Home</a></td></tr>
        <tr><td><a class="menu_list" href="/">Home</a></td></tr>
        <tr><td><a class="menu_list" href="/search">Search</a></td></tr>
        <tr><td><a class="menu_list" href="/favorites">Favorites</a></td></tr>
        <tr><td><a class="menu_list" href="/library">Library</a></td></tr>
        <tr><td><a class="menu_list" href="/add2lib">Add to Library</a></td></tr>
        <tr><td><a class="menu_list" href="/nav">Navigation</a></td></tr>
        <tr><td><a class="menu_list" href="/about">About</a></td></tr>
        <tr><td><a class="menu_list" href="/shutdown">Close App</a></td></tr>
    </table>
</div>

<script>
var pgLast = {{ pg_last }};
var chNo = {{ ch_no }};

function ShowMenu() {
    var x = document.getElementById("myDropdown");
    if (!x) return;
    x.style.display = (x.style.display === "block") ? "none" : "block";
}

function ToggleControls() {
    var c = document.getElementById("controlsBox");
    if (!c) return;
    c.style.display = (c.style.display === "block") ? "none" : "block";
}

function GoToPage() {
    var input = document.getElementById("pageInput");
    if (!input) return;

    var p = parseInt(input.value, 10);
    if (!isNaN(p) && p >= 1 && p <= pgLast) {
        window.location.href = "/manga_reader/ch/" + chNo + "/p" + p;
    }
}

document.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {
        GoToPage();
    }
});
</script>

</body>
</html>
